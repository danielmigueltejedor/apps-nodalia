name: Tailscale (Nodalia Beta)
version: 3.0.0-beta24
slug: tailscale_nodalia_beta
description: Zero config VPN for building secure networks (Nodalia beta build)
url: https://github.com/danielmigueltejedor/apps-nodalia

ingress: true
ingress_port: 0
ingress_stream: true

startup: services
panel_icon: mdi:vpn

arch:
  - aarch64
  - amd64

init: false
hassio_api: true
homeassistant_api: true
host_network: true

# host_dbus no es necesario para Tailscale -> mejor fuera
# host_dbus: true

privileged:
  - NET_ADMIN
  - NET_RAW

devices:
  - /dev/net/tun

map:
  - share:rw

ports:
  41641/udp: null

# ✅ Defaults para que la UI no empiece "vacía" y evitar errores por claves no existentes
options:
  setup_profile: custom
  log_level: info
  accept_dns: true
  accept_routes: false
  advertise_exit_node: false
  advertise_connector: false
  advertise_routes: []
  share_homeassistant: disabled
  share_on_port: 443
  snat_subnet_routes: true
  stateful_filtering: false
  tags: []
  taildrop: true
  userspace_networking: false
  webui_readonly: true
  support_tunnel_enabled: false
  support_tailnet_id: "T3mkMkmms321CNTRL"
  support_target_url: "http://127.0.0.1:8123"
  support_tunnel_ttl_minutes: 30
  exit_node: ""
  login_server: "https://controlplane.tailscale.com"

schema:
  setup_profile: list(custom|home_access|subnet_router|exit_node)?
  accept_dns: bool?
  accept_routes: bool?
  advertise_exit_node: bool?
  advertise_connector: bool?
  advertise_routes:
    - "match(^(((25[0-5]|(2[0-4]|1\\d|[1-9]?)\\d)\\.){3}(25[0-5]|(2[0-4]|1\\d|[1-9]?)\\d)\\/(3[0-2]|[12]?\\d)|[a-fA-F\\d.:]+:[a-fA-F\\d.:]+\\/(12[0-8]|(1[01]|[1-9]?)\\d))$)?"
  exit_node: str?
  log_level: list(trace|debug|info|notice|warning|error|fatal)?
  login_server: url?
  share_homeassistant: list(disabled|serve|funnel)?
  share_on_port: match(^(443|8443|10000)$)?
  snat_subnet_routes: bool?
  stateful_filtering: bool?
  tags:
    - "match(^tag:[a-zA-Z][a-zA-Z0-9-]*$)?"
  taildrop: bool?
  userspace_networking: bool?
  webui_readonly: bool?
  support_tunnel_enabled: bool?
  support_tailnet_id: str?
  support_target_url: match(^https?://.+$)?
  support_tunnel_ttl_minutes: int(5,180)?
